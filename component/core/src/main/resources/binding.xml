<binding>

  <mapping name="repository-service" class="org.exoplatform.services.jcr.config.RepositoryServiceConfiguration">
    <value name="default-repository" field="defaultRepositoryName" style="attribute" />
    <collection name="repositories" field="repositoryConfigurations"
      item-type="org.exoplatform.services.jcr.config.RepositoryEntry"
      factory="org.jibx.runtime.Utility.arrayListFactory" />
  </mapping>

  <mapping name="repository" class="org.exoplatform.services.jcr.config.RepositoryEntry">
    <value name="name" field="name" style="attribute" />
    <value name="system-workspace" field="systemWorkspaceName" style="attribute" />
    <value name="default-workspace" field="defaultWorkspaceName" style="attribute" />
    <value name="security-domain" field="securityDomain" />
    <value name="access-control" field="accessControl" usage="optional" />
    <value name="session-max-age" field="sessionTimeOut" usage="optional" />
    <value name="authentication-policy" field="authenticationPolicy" />
    <structure name="binary-temp" field="binaryTemp" usage="optional">
      <value name="directory-path" field="directoryPath" style="attribute" usage="optional" />
      <value name="max-buffer-size" field="maxBufferSize" style="attribute" usage="optional" />
      <!-- value name="copy-local-files" field="copyLocalFiles" style="attribute" usage="optional"/ -->
    </structure>
    <collection name="workspaces" field="workspaces" item-type="org.exoplatform.services.jcr.config.WorkspaceEntry" />
  </mapping>

  <mapping name="workspace" class="org.exoplatform.services.jcr.config.WorkspaceEntry">
    <value name="name" field="name" style="attribute" />
    <value name="auto-init-root-nodetype" field="autoInitializedRootNt" style="attribute" usage="optional" />
    <value name="auto-init-permissions" field="autoInitPermissions" style="attribute" usage="optional" />

    <structure name="container" field="container">
      <value name="class" field="type" style="attribute" />
      <collection name="properties" field="parameters" usage="optional"
        item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
        factory="org.jibx.runtime.Utility.arrayListFactory" />
      <collection name="value-storages" field="valueStorages" usage="optional"
        item-type="org.exoplatform.services.jcr.config.ValueStorageEntry" />
    </structure>
    
    <structure name="initializer" field="initializer" usage="optional">
      <value name="class" field="type" style="attribute" />
      <collection name="properties" field="parameters" usage="optional"
        item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
        factory="org.jibx.runtime.Utility.arrayListFactory" />
    </structure>

    <structure name="cache" field="cache" usage="optional">
      <value name="enabled" field="enabled" style="attribute" />
      <collection name="properties" field="parameters" usage="optional"
        item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
        factory="org.jibx.runtime.Utility.arrayListFactory" />
    </structure>

    <!-- TODO cleanup 
      structure name="search-manager" field="searchManager" usage="optional">
      <structure  field="queryHandler"/>
      <value name="queryClass" field="queryClass" usage="optional"/>
      </structure-->

    <structure name="query-handler" field="queryHandler" usage="optional">
      <value name="class" field="type" style="attribute" />
      <collection name="properties" field="parameters" usage="optional"
        item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
        factory="org.jibx.runtime.Utility.arrayListFactory" />
    </structure>

    <structure name="access-manager" field="accessManager" usage="optional">
      <value name="class" field="type" style="attribute" />
      <collection name="properties" field="parameters" usage="optional"
        item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
        factory="org.jibx.runtime.Utility.arrayListFactory" />
    </structure>

    <structure name="lock-manager" field="lockManager" usage="optional">
      <value name="time-out" field="timeout" usage="optional" />
      <structure name="persister" field="persister" usage="optional">
        <value name="class" field="type" style="attribute" />
        <collection name="properties" field="parameters" usage="optional"
          item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
          factory="org.jibx.runtime.Utility.arrayListFactory" />
      </structure>
    </structure>
  </mapping>

  <mapping name="property" class="org.exoplatform.services.jcr.config.SimpleParameterEntry">
    <value name="name" field="name" style="attribute" />
    <value name="value" field="value" style="attribute" />
  </mapping>

  <!-- TODO cleanup
    <mapping  class="org.exoplatform.services.jcr.config.QueryHandlerEntry" name="queryHandler" ordered="false">
    <value name="indexDir"  field="indexDir"/>
    <value name="systemIndexDir" field="systemIndexDir" usage="optional"/>
    <value name="volatileIdleTime" field="volatileIdleTime" usage="optional" default="3"/>
    
    <value name="minMergeDocs" field="minMergeDocs"  usage="optional"  default="100"/>
    <value name="maxMergeDocs" field="maxMergeDocs"  usage="optional" default="2147483647"/>
    <value name="mergeFactor" field="mergeFactor"  usage="optional" default="10"/>
    <value name="maxFieldLength" field="maxFieldLength"  usage="optional" default="10000"/>
    <value name="bufferSize" field="bufferSize"  usage="optional" default="10"/>
    
    <value name="documentOrder" field="documentOrder"  usage="optional" default="true"/>
    <value name="useCompoundFile" field="useCompoundFile"  usage="optional" default="true"/>
    
    <value name="forceConsistencyCheck" field="forceConsistencyCheck"  usage="optional" default="false"/>
    <value name="consistencyCheckEnabled" field="consistencyCheckEnabled"  usage="optional" default="false"/>
    <value name="autoRepair" field="autoRepair"  usage="optional" default="true"/>
    <value name="cacheSize" field="cacheSize"  usage="optional" default="1000"/>
    <value name="supportHighlighting" field="supportHighlighting"  usage="optional" default="false"/>
    <value name="indexingConfigPath" field="indexingConfigPath"  usage="optional"/>
    <value name="synonymProvider" field="synonymProvider"  usage="optional"  set-method="setSynonymProvider"/>
    <value name="synonymProviderConfigPath" field="synonymProviderConfigPath"  usage="optional"/>
    </mapping>
    
  -->

  <mapping name="value-storage" class="org.exoplatform.services.jcr.config.ValueStorageEntry">
    <value name="class" field="type" style="attribute" />
    <value name="id" field="id" style="attribute" />
    <collection name="properties" field="parameters" usage="optional"
      item-type="org.exoplatform.services.jcr.config.SimpleParameterEntry"
      factory="org.jibx.runtime.Utility.arrayListFactory" />
    <collection name="filters" field="filters" item-type="org.exoplatform.services.jcr.config.ValueStorageFilterEntry" />
  </mapping>
  <mapping name="filter" class="org.exoplatform.services.jcr.config.ValueStorageFilterEntry">
    <value name="property-type" field="propertyType" style="attribute" usage="optional" />
    <value name="min-value-size" field="minValueSize" style="attribute" usage="optional" />
    <value name="ancestor-path" field="ancestorPath" style="attribute" usage="optional" />
    <value name="property-name" field="propertyName" style="attribute" usage="optional" />
  </mapping>

</binding>
